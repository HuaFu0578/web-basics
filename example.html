<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      const arr = [
        {
          id: 0,
          data: 1,
        },
        {
          pid: 0,
          id: 1,
          data: 2,
        },
        {
          pid: 0,
          id: 2,
          data: 3,
        },
        {
          pid: 3,
          id: 4,
          data: 5,
        },
        {
          pid: 2,
          id: 3,
          data: 4,
        },
      ]
      function toTree(arr) {
        const cache = {} // map映射表 
        const result = [] // 初始化结果
        // 构建映射表
        arr.forEach((item) => {
          cache[item.id] = item
        })
        arr.forEach((item) => {
          const parent = cache[item.pid]
          if (!parent) {
            result.push(item) // 初始化添加元素
          } else {
            // 添加本元素到父元素的children 通过对象指针的引用机制添加到父元素中
            ;(parent.children || (parent.children = [])).push(item)
          }
        })
        // 源数据
        return result
      }
      const toTreeArr = toTree(arr)
      console.log('checkoutArr', toTreeArr)
    </script>
  </body>
</html>
